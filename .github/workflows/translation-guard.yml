name: test

on:
  pull_request:
    types:
      - opened
      - synchronize
      - labeled
      - unlabeled
      - reopened

jobs:
  check-labels:
    runs-on: ubuntu-latest

    steps:
      - run: |
          labels='${{ toJSON(github.event.pull_request.labels.*.name) }}'
          language_labels=(":es: ES" ":indonesia: ID" ":cn: ZH")


          has_label() {
              [ `echo $labels | jq -rcM ". | index(\"$1\")"` != "null" ]
          }


          if has_label "ready for translation"; then
              for language_label in $language_labels; do
                  if ! has_label "$language_label"; then
                      echo "Error: Missing language label '$language_label'"
                      exit 1
                  else
                      echo "Found language label '$language_label'"
                  fi
              done
          elif ! has_label "time-sensitive" && ! has_label "not translatable"; then
              echo "Error: Missing required labels 'time-sensitive' or 'not translatable'"
              exit 1
          fi

