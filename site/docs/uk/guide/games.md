---
prev: ./files.md
next: ./deployment-types.md
---

# Ігри

## Вступ

Ігри Telegram — це дуже цікава функція, з якою дуже весело грати.
Що з цим можна робити?
Відповідь: будь-яку гру HTML5, яку ви розробили, ви можете надати користувачам Telegram за допомогою цієї функції.
Так, це означає, що вам доведеться розробити справжню гру на вебсайті, яка є загальнодоступною в Інтернеті, перш ніж ви зможете інтегрувати її у свого бота Telegram.

## Налаштування гри з вашим ботом через @BotFather

Для простоти припустимо, що на даний момент ви маєте налаштувати бота та пов’язану з ним гру в [@BotFather](https://t.me/BotFather).
Якщо ви ще цього не зробили, перегляньте цю [статтю](https://core.telegram.org/bots/games) від команди Telegram.

> Примітка: ми вивчатимемо лише розробку ботів.
> Розробка гри повністю залежить від розробника.
> Все, що нам тут потрібно, це посилання на гру HTML5, розміщену в Інтернеті.

## Надсилання гри через бота

Ми можемо надіслати гру в grammY за допомогою методу `replyWithGame`, який приймає назву гри, яку ви створили за допомогою BotFather, як аргумент.
Крім того, ми також можемо використати метод `api.sendGame`, адже grammY надає всі офіційні методи [Bot API](https://core.telegram.org/bots/api).
Перевага використання методу `api.sendGame` полягає в тому, що ви можете вказати `chat.id` конкретного користувача, якому потрібно надіслати гру.

1. Надсилання гри через `replyWithGame`

   ```ts
   // Використовуватимемо команду start для виклику методу відповіді грою.
   bot.command("start", async (ctx) => {
     // Передаємо назву гри, яку ми створили в BotFather: наприклад, "my_game".
     await ctx.replyWithGame("my_game");
   });
   ```

2. Надсилання гри через `api.sendGame`

   ```ts
   bot.command("start", async (ctx) => {
     // Отримаємо ідентифікатор чату користувача, якому потрібно надіслати гру, за допомогою `ctx.from.id`,
     // який повертає ідентифікатор чату користувача, який відправив команду start.
     const chatId = ctx.from.id;
     await ctx.api.sendGame(chatid, "my_game");
   });
   ```

> [Пам’ятайте](./basics.md#надсилання-повідомлень), що ви можете вказати додаткові параметри під час надсилання повідомлень за допомогою об’єкта параметрів типу `Other`.

Ви також можете вказати спеціальну [вбудовану клавіатуру](../plugins/keyboard.md#вбудовані-клавіатури), щоб у грі відображалися кнопки.
За замовчуванням її буде надіслано разом із кнопкою з назвою `Грати в my_game`, де _my_game_ — це назва вашої гри.

```ts
// Визначаємо нову вбудовану клавіатуру. Ви можете написати будь-який текст,
// який буде показано на кнопці, але переконайтеся, що перша кнопка завжди є
// бути кнопкою запуску гри!

const keyboard = new InlineKeyboard().game("Запустити my_game");

// Зверніть увагу, що ми використали game() на відміну від звичайної вбудованої клавіатури
// де ми використовуємо url() або text()

// За допомогою методу `replyWithGame`
await ctx.replyWithGame("my_game", { reply_markup: keyboard });

// За допомогою методу `api.sendGame`
await ctx.api.sendGame(chatId, "my_game", { reply_markup: keyboard });
```

## Прослуховування зворотного виклику нашої ігрової кнопки

Для надання логіки кнопці під час її натискання та для перенаправлення наших користувачів до нашої гри та багато іншого ми слухаємо подію `callback_query:game_short_name`, яка повідомляє нам, що користувач натиснув кнопку гри.
Усе, що нам потрібно зробити, це:

```ts
// Передаємо тут URL-адресу гри, яка вже має бути розміщена в Інтернеті.

bot.on("callback_query:game_short_name", async (ctx) => {
  await ctx.answerCallbackQuery({ url: "посилання на гру" });
});
```

---

### Наш остаточний код має виглядати приблизно так

```ts
bot.on("callback_query:game_short_name", async (ctx) => {
  await ctx.answerCallbackQuery({ url: "посилання на гру" });
});

bot.command("start", (ctx) => {
  await ctx.replyWithGame("my_game", {
    reply_markup: keyboard,
    // Або ви можете скористатися тут методом API відповідно до ваших потреб.
  });
});
```

> Не забудьте додати правильну [обробку помилок](./errors.md) до свого бота перед тим, як запускати його.

У майбутньому ми можемо розширити цю статтю додатковими розширеними розділами та поширеними запитаннями, але це вже все, що вам потрібно, щоб запустити гру в Telegram.
Веселої гри! :space_invader:
