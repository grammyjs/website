# ä¼šè¯ä¸æ•°æ®å­˜å‚¨ï¼ˆå†…ç½®ï¼‰

ä½ å¯ä»¥é€šè¿‡è‡ªå·±ç¼–å†™ä»£ç æ¥å®ç°è¿æ¥ä½ é€‰æ‹©çš„æ•°æ®å­˜å‚¨ï¼Œä½†æ˜¯ grammY æä¾›äº†ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„å­˜å‚¨æ¨¡å¼ï¼Œç§°ä¸º _ä¼šè¯_ã€‚

> [å‘ä¸‹è·³è½¬](#å¦‚ä½•ä½¿ç”¨ä¼šè¯) å¦‚æœä½ å·²ç»çŸ¥é“ä¼šè¯æ˜¯æ€æ ·å·¥ä½œçš„ã€‚

## ä¸ºä»€ä¹ˆæˆ‘ä»¬å¿…é¡»è€ƒè™‘å­˜å‚¨é—®é¢˜ï¼Ÿ

å’Œ Telegram ä¸Šçš„æ™®é€šç”¨æˆ·ç›¸åï¼Œbot åœ¨ Telegram äº‘ä¸­åªæœ‰ [æœ‰é™çš„äº‘å­˜å‚¨ç©ºé—´](https://core.telegram.org/bots#4-how-are-bots-different-from-humans) ã€‚
å› æ­¤ï¼Œä¸‹é¢è¿™å‡ ä»¶äº‹ä½ ä¸èƒ½ç”¨ bot æ¥åšï¼š

1. ä½ ä¸èƒ½è®¿é—®ä½ çš„ bot æ”¶åˆ°çš„æ—§æ¶ˆæ¯ã€‚
2. ä½ ä¸èƒ½è®¿é—®ä½ çš„ bot å‘é€çš„æ—§æ¶ˆæ¯ã€‚
3. ä½ ä¸èƒ½è·å–æ‰€æœ‰ä¸ä½ çš„ bot èŠå¤©çš„åˆ—è¡¨ã€‚
4. è¿˜æœ‰æ›´å¤šï¼Œæ¯”å¦‚æ²¡æœ‰åª’ä½“æ¦‚è§ˆç­‰

åŸºæœ¬ä¸Šï¼Œå®ƒå¯ä»¥æ€»ç»“æˆè¿™æ ·ä¸€ä¸ªäº‹å®ï¼Œå³**ä¸€ä¸ª bot åªèƒ½è®¿é—®å½“å‰ä¼ å…¥çš„ update**ï¼ˆæ¯”å¦‚æ¶ˆæ¯ï¼‰ï¼Œå³ä¸Šä¸‹æ–‡å¯¹è±¡ `ctx` ä¸Šçš„ä¿¡æ¯ã€‚

å› æ­¤ï¼Œå¦‚æœä½  _çœŸçš„æƒ³è®¿é—®_ æ—§æ•°æ®ï¼Œä½ å¿…é¡»åœ¨æ”¶åˆ°å®ƒæ—¶ç«‹åˆ»æŠŠå®ƒå­˜ä¸‹æ¥ã€‚
ä¹Ÿå°±æ˜¯è¯´ä½ å¿…é¡»æœ‰ä¸€ä¸ªæ•°æ®å­˜å‚¨ï¼Œæ¯”å¦‚è¯´æ–‡ä»¶ã€æ•°æ®åº“æˆ–è€…å†…å­˜å­˜å‚¨ã€‚

å½“ç„¶ï¼ŒgrammY åœ¨è¿™é‡Œä¸ºä½ æä¾›äº†ä¿éšœï¼šä½ ä¸éœ€è¦è‡ªå·±æ‰˜ç®¡ã€‚
ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ grammY çš„ä¼šè¯å­˜å‚¨ï¼Œå®ƒä¸éœ€è¦ä»»ä½•è®¾ç½®ï¼Œè€Œä¸”æ°¸ä¹…å…è´¹ã€‚

> å½“ç„¶ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–æä¾›æ•°æ®å­˜å‚¨çš„æœåŠ¡ï¼Œè€Œ grammY ä¹Ÿèƒ½ä¸å®ƒä»¬æ— ç¼æ•´åˆã€‚
> å¦‚æœä½ æƒ³è¿è¡Œè‡ªå·±çš„æ•°æ®åº“ï¼Œè¯·æ”¾å¿ƒï¼ŒgrammY åŒæ ·æ”¯æŒè¿™ä¸ªçš„èƒ½åŠ›ã€‚
> [å‘ä¸‹è·³è½¬](#å·²çŸ¥çš„å­˜å‚¨é€‚é…å™¨) æŸ¥çœ‹ç›®å‰æ”¯æŒçš„é›†æˆã€‚

## ä»€ä¹ˆæ˜¯ä¼šè¯ï¼Ÿ

é€šå¸¸æƒ…å†µä¸‹ï¼Œå¯¹äº bot æ¥è¯´ï¼Œæ¯æ¬¡èŠå¤©éƒ½ä¼šå­˜å‚¨ä¸€äº›æ•°æ®ã€‚
ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬æƒ³å»ºç«‹ä¸€ä¸ª botï¼Œè®¡ç®—ä¸€æ¡æ¶ˆæ¯çš„æ–‡æœ¬ä¸­åŒ…å«æŠ«è¨è¡¨æƒ… :pizza: çš„æ¬¡æ•°ã€‚
è¿™ä¸ª bot å¯ä»¥æ·»åŠ åˆ°ä¸€ä¸ªå°ç»„é‡Œï¼Œå¹¶ä¸”å®ƒå¯ä»¥å‘Šè¯‰ä½ ï¼Œä½ å’Œä½ çš„æœ‹å‹æœ‰å¤šå–œæ¬¢æŠ«è¨ã€‚

å½“æˆ‘ä»¬çš„æŠ«è¨ bot æ”¶åˆ°ä¸€æ¡æ¶ˆæ¯æ—¶ï¼Œå®ƒå¿…é¡»è®°ä½ä¹‹å‰åœ¨å½“å‰èŠå¤©ä¸­çœ‹åˆ°è¿‡å¤šå°‘æ¬¡ :pizza:ã€‚
å¹¶ä¸”å½“ä½ çš„å¦¹å¦¹å°†æŠ«è¨ bot æ·»åŠ åˆ°å¥¹çš„ç¾¤èŠä¸­æ—¶ï¼Œåˆ«çš„æŠ«è¨è®¡æ•°å™¨ä¸åº”è¯¥å‘ç”Ÿæ”¹å˜ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çœŸæ­£æƒ³è¦çš„æ˜¯å¯ä»¥å­˜å‚¨ _æ¯ä¸ªèŠå¤©ä¸€ä¸ªè®¡æ•°å™¨_ã€‚

ä¼šè¯å°±æ˜¯è¿™æ ·ä¸€ç§ä¼˜é›…çš„æ–¹å¼æ¥ç»™ _æ¯ä¸ªèŠå¤©_ å­˜å‚¨æ•°æ®ã€‚
ä½ å°†ä¼šä½¿ç”¨èŠå¤©æ ‡è¯†ç¬¦æ¥ä½œä¸ºæ•°æ®åº“çš„é”®ï¼Œå’Œä¸€ä¸ªè®¡æ•°å™¨ä½œä¸ºå€¼ã€‚
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šæŠŠèŠå¤©æ ‡è¯†ç¬¦ç§°ä¸º _ä¼šè¯å¯†é’¥_ã€‚

> ä½ å¯ä»¥åœ¨ [è¿™é‡Œ](#ä¼šè¯å¯†é’¥) é˜…è¯»æ›´å¤šå…³äºä¼šè¯å¯†é’¥çš„ä¿¡æ¯ã€‚

æˆ‘ä»¬å¯ä»¥åœ¨ bot ä¸Šå®‰è£…ä¸­é—´ä»¶ï¼Œè¿™ä¸ªä¸­é—´ä»¶ä¼šåœ¨è¿è¡Œå‰ï¼Œä»æ•°æ®åº“ä¸­åŠ è½½èŠå¤©ä¼šè¯æ•°æ®åˆ° `ctx.session` æ¥æä¾›ç»™æ¯ä¸ª updateã€‚
å®ƒè¿˜ä¼šç¡®ä¿ä¸€æ—¦æˆ‘ä»¬å®Œæˆäº†å·¥ä½œï¼Œä¼šè¯æ•°æ®å°±ä¼šè¢«å†™å›æ•°æ®åº“ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨å†æ‹…å¿ƒä¸æ•°æ®å­˜å‚¨çš„å®é™…é€šä¿¡äº†ã€‚

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¼šè¯å¯¹è±¡ `ctx.session` ä¸Šè®¿é—® _å¯¹åº”çš„èŠå¤©_ çš„æŠ«è¨æ•°é‡ã€‚

## å¦‚ä½•ä½¿ç”¨ä¼šè¯

ä½ å¯ä»¥æ·»åŠ å†…ç½®çš„ä¼šè¯ä¸­é—´ä»¶æ¥ä¸º grammY æ·»åŠ ä¼šè¯æ”¯æŒã€‚

### ä½¿ç”¨ç¤ºä¾‹

ä¸‹é¢æ˜¯ä¸€ä¸ªè®¡ç®—å«æœ‰æŠ«è¨è¡¨æƒ… :pizza: çš„ä¿¡æ¯çš„ bot ä¾‹å­

<CodeGroup>
 <CodeGroupItem title="TypeScript" active>

```ts
import { Bot, Context, session, SessionFlavor } from "grammy";

// å®šä¹‰æˆ‘ä»¬çš„ä¼šè¯ã€‚
interface SessionData {
  pizzaCount: number;
}

// å¯¹ä¸Šä¸‹æ–‡ç±»å‹è¿›è¡Œä¿®é¥°ä»¥åŒ…å«ä¼šè¯ã€‚
type MyContext = Context & SessionFlavor<SessionData>;

const bot = new Bot<MyContext>("");

// å®‰è£…ä¼šè¯ä¸­é—´ä»¶ï¼Œå¹¶å®šä¹‰ä¼šè¯åˆå§‹å€¼ã€‚
function initial(): SessionData {
  return { pizzaCount: 0 };
}
bot.use(session({ initial }));

bot.command("hunger", async (ctx) => {
  const count = ctx.session.pizzaCount;
  await ctx.reply(`Your hunger level is ${count}!`);
});

bot.hears(/.*ğŸ•.*/, (ctx) => ctx.session.pizzaCount++);

bot.start();
```

</CodeGroupItem>
 <CodeGroupItem title="JavaScript">

```js
const { Bot, session } = require("grammy");

const bot = new Bot("");

// å®‰è£…ä¼šè¯ä¸­é—´ä»¶ï¼Œå¹¶å®šä¹‰ä¼šè¯åˆå§‹å€¼ã€‚
function initial(): SessionData {
  return { pizzaCount: 0 };
}
bot.use(session({ initial }));

bot.command("hunger", async (ctx) => {
  const count = ctx.session.pizzaCount;
  await ctx.reply(`Your hunger level is ${count}!`);
});

bot.hears(/.*ğŸ•.*/, (ctx) => ctx.session.pizzaCount++);

bot.start();
```

</CodeGroupItem>
 <CodeGroupItem title="Deno">

```ts
import {
  Bot,
  Context,
  session,
  SessionFlavor,
} from "https://deno.land/x/grammy/mod.ts";

// å®šä¹‰æˆ‘ä»¬çš„ä¼šè¯ã€‚
interface SessionData {
  pizzaCount: number;
}

// å¯¹ä¸Šä¸‹æ–‡ç±»å‹è¿›è¡Œä¿®é¥°ä»¥åŒ…å«ä¼šè¯ã€‚
type MyContext = Context & SessionFlavor<SessionData>;

const bot = new Bot<MyContext>("");

// å®‰è£…ä¼šè¯ä¸­é—´ä»¶ï¼Œå¹¶å®šä¹‰ä¼šè¯åˆå§‹å€¼ã€‚
function initial(): SessionData {
  return { pizzaCount: 0 };
}
bot.use(session({ initial }));

bot.command("hunger", async (ctx) => {
  const count = ctx.session.pizzaCount;
  await ctx.reply(`Your hunger level is ${count}!`);
});

bot.hears(/.*ğŸ•.*/, (ctx) => ctx.session.pizzaCount++);

bot.start();
```

</CodeGroupItem>
</CodeGroup>

è¯·æ³¨æ„ï¼Œæˆ‘ä»¬è¿˜å¿…é¡» [è°ƒæ•´ä¸Šä¸‹æ–‡ç±»å‹](/zh/guide/context.md#customising-the-context-object)ï¼Œä½¿å¾—ä¼šè¯å¯ä»¥åœ¨ä¸Šä¸‹æ–‡ä¸Šä½¿ç”¨ã€‚
ä¸Šä¸‹æ–‡ä¿®é¥°å™¨è¢«ç§°ä¸º `SessionFlavor`ã€‚

### åˆå§‹åŒ–ä¼šè¯æ•°æ®

å½“ä¸€ä¸ªç”¨æˆ·ç¬¬ä¸€æ¬¡è”ç³»ä½ çš„ bot æ—¶ï¼Œä»–ä»¬æ²¡æœ‰ä»»ä½•ä¼šè¯æ•°æ®å¯ä»¥ä½¿ç”¨ã€‚
å› æ­¤ï¼Œä½ éœ€è¦åœ¨ä¼šè¯ä¸­é—´ä»¶ä¸­æŒ‡å®š `initial` é€‰é¡¹ã€‚
ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œä¸ºæ–°çš„èŠå¤©ç”Ÿæˆä¸€ä¸ªå¸¦æœ‰åˆå§‹ä¼šè¯æ•°æ®çš„æ–°å¯¹è±¡ã€‚

```ts
// åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œä½œä¸ºåˆå§‹ä¼šè¯æ•°æ®ä½¿ç”¨ã€‚
function createInitialSessionData() {
  return {
    pizzaCount: 0,
    // æ›´å¤šæ•°æ®æ”¾åœ¨è¿™é‡Œ
  };
}
bot.use(session({ initial: createInitialSessionData }));
```

ç›¸åŒä½†æ›´çŸ­çš„å†™æ³•ï¼š

```ts
bot.use(session({ initial: () => ({ pizzaCount: 0 }) }));
```

::: warning å…±äº«å¯¹è±¡
è¯·ç¡®ä¿æ€»æ˜¯åˆ›å»ºä¸€ä¸ª _æ–°çš„å¯¹è±¡_ã€‚
**ä¸è¦**è¿™æ ·åšï¼š

```ts
// å±é™©çš„ï¼Œä¸å®‰å…¨çš„ï¼Œé”™è¯¯çš„ï¼Œåº”è¯¥è¢«åˆ¶æ­¢çš„
const initialData = { pizzaCount: 0 }; // ä¸è¦è¿™ä¹ˆå¹²
bot.use(session({ initial: { initialData } })); // é‚ªæ¶çš„
```

å¦‚æœä½ è¿™æ ·åšï¼Œå‡ ä¸ªä¸åŒçš„èŠå¤©å®¤å¯èƒ½ä¼šåœ¨å†…å­˜ä¸­å…±äº«åŒä¸€ä¸ªä¼šè¯å¯¹è±¡ã€‚
å› æ­¤ï¼Œåœ¨ä¸€ä¸ªèŠå¤©ä¸­æ›´æ”¹ä¼šè¯æ•°æ®å¯èƒ½ä¼šå¯¼è‡´å¦ä¸€ä¸ªèŠå¤©çš„ä¼šè¯æ•°æ®ä¹Ÿè¢«æ›´æ”¹ã€‚
:::

ä½ ä¹Ÿå¯ä»¥å®Œå…¨å¿½ç•¥ `initial` é€‰é¡¹ï¼Œå°½ç®¡æˆ‘ä»¬å»ºè®®ä½ ä¸è¦è¿™æ ·åšã€‚
å¦‚æœä½ ä¸æŒ‡å®šå®ƒï¼Œè¯»å– `ctx.session` æ—¶å°†ä¼šç»™æ–°ç”¨æˆ·æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚

### ä¼šè¯å¯†é’¥

> æœ¬ç« èŠ‚ä»‹ç»ä¸€ä¸ªå¤§å¤šæ•°äººä¸éœ€è¦å…³å¿ƒçš„é«˜çº§ç‰¹æ€§ã€‚
> ä½ å¯èƒ½æƒ³ç»§ç»­é˜…è¯»æœ‰å…³ [å­˜å‚¨æ•°æ®](#å‚¨å­˜ä½ çš„æ•°æ®) çš„ç« èŠ‚ã€‚

ä½ å¯ä»¥é€šè¿‡å‘ [options](https://doc.deno.land/https://deno.land/x/grammy/mod.ts/~/SessionOptions#getSessionKey) ä¼ å…¥ä¸€ä¸ªåä¸º `getSessionKey` çš„å‡½æ•°æ¥æŒ‡å®šä¼šè¯ä½¿ç”¨å“ªä¸ªä¼šè¯å¯†é’¥ã€‚
è¿™æ ·ï¼Œä½ å¯ä»¥ä»æ ¹æœ¬ä¸Šæ”¹å˜ä¼šè¯æ’ä»¶çš„å·¥ä½œæ–¹å¼ã€‚
é»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šè¯æ•°æ®å­˜å‚¨åœ¨æ¯ä¸ªèŠå¤©ä¸­ã€‚
ä½¿ç”¨ `getSessionKey`ï¼Œä½ å¯ä»¥æŒ‰æ¯ä¸ªç”¨æˆ·ï¼Œæˆ–æ¯ä¸ªç”¨æˆ·-èŠå¤©ç»„åˆï¼Œæˆ–ä»»ä½•ä½ æƒ³è¦çš„æ–¹å¼å­˜å‚¨æ•°æ®ã€‚
è¿™é‡Œæœ‰ä¸‰ä¸ªç¤ºä¾‹ï¼š

<CodeGroup>
<CodeGroupItem title="TypeScript" active>

```ts
// ä¸ºæ¯ä¸ªèŠå¤©å­˜å‚¨æ•°æ®ï¼ˆé»˜è®¤ï¼‰ã€‚
function getSessionKey(ctx: Context): string | undefined {
  // è®©ç¾¤èŠä¸­çš„æ‰€æœ‰ç”¨æˆ·å…±äº«åŒä¸€ä¸ªä¼šè¯ï¼Œ
  // ä½†ç§èŠä¸­æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç§äººä¼šè¯
  return ctx.chat?.id.toString();
}
// ä¸ºæ¯ä¸ªç”¨æˆ·å­˜å‚¨æ•°æ®ã€‚
function getSessionKey(ctx: Context): string | undefined {
  // ç»™æ¯ä¸ªç”¨æˆ·æä¾›ä¸€ä¸ªç§äººçš„ä¼šè¯å­˜å‚¨
  //ï¼ˆå°†åœ¨ç¾¤èŠå’Œç§äººèŠå¤©ä¸­å…±äº«ï¼‰
  return ctx.from?.id.toString();
}
// ä¸ºç”¨æˆ·-èŠå¤©ç»„åˆå­˜å‚¨æ•°æ®ã€‚
function getSessionKey(ctx: Context): string | undefined {
  // åœ¨æ¯æ¬¡ä¸ bot èŠå¤©æ—¶ï¼Œç»™æ¯ä¸ªç”¨æˆ·ä¸€ä¸ªç‹¬ç«‹çš„ä¼šè¯å­˜å‚¨
  // ï¼ˆç»™æ¯ä¸ªç¾¤èŠå’Œç§äººèŠå¤©ä¸€ä¸ªç‹¬ç«‹çš„ä¼šè¯å­˜å‚¨ï¼‰
  return ctx.from === undefined || ctx.chat === undefined
    ? undefined
    : `${ctx.from.id}/${ctx.chat.id}`;
}
bot.use(session({ getSessionKey }));
```

</CodeGroupItem>
<CodeGroupItem title="JavaScript">

```js
// ä¸ºæ¯ä¸ªèŠå¤©å­˜å‚¨æ•°æ®ï¼ˆé»˜è®¤ï¼‰ã€‚
function getSessionKey(ctx) {
  // è®©ç¾¤èŠä¸­çš„æ‰€æœ‰ç”¨æˆ·å…±äº«åŒä¸€ä¸ªä¼šè¯ï¼Œ
  // ä½†ç§èŠä¸­æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç§äººä¼šè¯
  return ctx.chat?.id.toString();
}
// ä¸ºæ¯ä¸ªç”¨æˆ·å­˜å‚¨æ•°æ®ã€‚
function getSessionKey(ctx) {
  // ç»™æ¯ä¸ªç”¨æˆ·æä¾›ä¸€ä¸ªç§äººçš„ä¼šè¯å­˜å‚¨
  //ï¼ˆå°†åœ¨ç¾¤èŠå’Œç§äººèŠå¤©ä¸­å…±äº«ï¼‰
  return ctx.from?.id.toString();
}
// ä¸ºç”¨æˆ·-èŠå¤©ç»„åˆå­˜å‚¨æ•°æ®ã€‚
function getSessionKey(ctx) {
  // åœ¨æ¯æ¬¡ä¸ bot èŠå¤©æ—¶ï¼Œç»™æ¯ä¸ªç”¨æˆ·ä¸€ä¸ªç‹¬ç«‹çš„ä¼šè¯å­˜å‚¨
  // ï¼ˆç»™æ¯ä¸ªç¾¤èŠå’Œç§äººèŠå¤©ä¸€ä¸ªç‹¬ç«‹çš„ä¼šè¯å­˜å‚¨ï¼‰
  return ctx.from === undefined || ctx.chat === undefined
    ? undefined
    : `${ctx.from.id}/${ctx.chat.id}`;
}
bot.use(session({ getSessionKey }));
```

</CodeGroupItem>
</CodeGroup>

å½“ `getSessionKey` è¿”å› `undefined` æ—¶ï¼Œ`ctx.session` ä¹Ÿä¼šè¢«è®¾ç½®ä¸º `undefined`ã€‚
ä¸¾ä¸ªä¾‹å­ï¼Œé»˜è®¤çš„ä¼šè¯å¯†é’¥è§£æå™¨ä¸èƒ½å¤„ç† `poll`/`poll_answer` update æˆ– `inline_query` updateï¼Œå› ä¸ºå®ƒä»¬ä¸å±äºä¸€ä¸ªèŠå¤©ï¼ˆ`ctx.chat` æ˜¯ `undefined`ï¼‰ã€‚

::: warning ä¼šè¯å¯†é’¥å’Œ webhooks
å½“ä½ åœ¨ webhooks ä¸Šè¿è¡Œä½ çš„ botï¼Œä½ åº”è¯¥é¿å…ä½¿ç”¨ `getSessionKey` é€‰é¡¹ã€‚
Telegram åœ¨æ¯æ¬¡èŠå¤©æ—¶éƒ½ä¼šæŒ‰ç…§é¡ºåºå‘é€ webhooksï¼Œå› æ­¤é»˜è®¤çš„ä¼šè¯å¯†é’¥è§£æå™¨æ˜¯å”¯ä¸€èƒ½ä¿è¯ä¸ä¼šä¸¢å¤±æ•°æ®çš„å®ç°ã€‚

å¦‚æœä½ å¿…é¡»ä½¿ç”¨è¯¥é€‰é¡¹ï¼ˆå½“ç„¶ï¼Œè¿™ä»ç„¶æ˜¯å¯èƒ½çš„ï¼‰ï¼Œä½ åº”è¯¥çŸ¥é“ä½ åœ¨åšä»€ä¹ˆã€‚
é€šè¿‡é˜…è¯» [è¿™ä¸ª](/zh/guide/deployment-types.md)ï¼Œç‰¹åˆ«æ˜¯ [è¿™ä¸ª](/zh/plugins/runner.md#ä¸ºä»€ä¹ˆéœ€è¦é¡ºåºå¤„ç†)ï¼Œç¡®ä¿ä½ äº†è§£ä½¿ç”¨è¿™ä¸ªé…ç½®çš„åæœã€‚
:::

### å‚¨å­˜ä½ çš„æ•°æ®

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä¼šè¯æ•°æ®å­˜å‚¨åœ¨ä½ çš„å†…å­˜ä¸­ï¼Œæ‰€ä»¥ä¸€æ—¦ä½ çš„ bot è¢«åœæ­¢äº†ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½ä¼šä¸¢å¤±ã€‚
å½“ä½ å¼€å‘ bot æˆ–è€…è¿è¡Œè‡ªåŠ¨æµ‹è¯•æ—¶ï¼Œè¿™æ ·ä¼šå¾ˆæ–¹ä¾¿ï¼ˆå› ä¸ºä¸éœ€è¦é…ç½®æ•°æ®åº“ï¼‰ï¼Œä½†æ˜¯ä¸åº”è¯¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚
åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½ åº”è¯¥ä½¿ç”¨ä¼šè¯ä¸­é—´ä»¶çš„ storage é€‰é¡¹ï¼Œå°†å®ƒè¿æ¥åˆ°ä½ çš„æ•°æ®å­˜å‚¨ä¸­ã€‚
è¿™é‡Œå¯èƒ½å·²ç»æœ‰ä½ éœ€è¦å¹¶ä¸”å¯ä»¥ä½¿ç”¨çš„ä¸º grammY ç¼–å†™çš„å­˜å‚¨é€‚é…å™¨ï¼ˆè§ [ä¸‹æ–‡](#å·²çŸ¥çš„å­˜å‚¨é€‚é…å™¨)ï¼‰ï¼Œå¦‚æœæ²¡æœ‰ï¼Œé€šå¸¸åªéœ€è¦ 5 è¡Œä»£ç å°±å¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªã€‚

## æ‡’ä¼šè¯

> æœ¬ç« èŠ‚ä»‹ç»äº†å¤§å¤šæ•°äººä¸éœ€è¦å…³å¿ƒçš„æ€§èƒ½ä¼˜åŒ–ã€‚
> ä½ å¯èƒ½æƒ³ç»§ç»­å†™é˜…è¯»æœ‰å…³ [å·²çŸ¥çš„å­˜å‚¨é€‚é…å™¨](#å·²çŸ¥çš„å­˜å‚¨é€‚é…å™¨) çš„ç« èŠ‚ã€‚

æ‡’ä¼šè¯æ˜¯ä¼šè¯çš„å¦ä¸€ç§å®ç°æ–¹å¼ï¼Œé€šè¿‡è·³è¿‡å¤šä½™çš„è¯»å†™æ“ä½œï¼Œå¯ä»¥å¤§å¤§å‡å°‘ä½ çš„ bot çš„æ•°æ®åº“æµé‡ã€‚

å‡è®¾ä½ çš„ bot åœ¨ä¸€ä¸ªç¾¤ç»„èŠå¤©ä¸­ï¼Œå®ƒåªå“åº”å‘½ä»¤è€Œä¸å“åº”æ™®é€šçš„æ–‡æœ¬æ¶ˆæ¯ã€‚
æ²¡æœ‰ä¼šè¯æ—¶ï¼Œä¼šå‘ç”Ÿä¸‹åˆ—æƒ…å†µï¼š

1. é™„å¸¦æ–°çš„æ–‡æœ¬æ¶ˆæ¯çš„ update ä¼šè¢«å‘é€åˆ°ä½ çš„ bot ä¸Š
2. æ²¡æœ‰è°ƒç”¨å¤„ç†ç¨‹åºï¼Œæ‰€ä»¥ä¸é‡‡å–ä»»ä½•è¡ŒåŠ¨
3. ä¸­é—´ä»¶ä¼šç«‹åˆ»å®Œæˆ

ä¸€æ—¦ä½ æ·»åŠ äº†ï¼ˆé»˜è®¤ï¼Œä¸¥æ ¼ï¼‰çš„ä¼šè¯ï¼Œç›´æ¥åœ¨ä¸Šä¸‹æ–‡å¯¹è±¡ä¸­æä¾›ä¼šè¯æ•°æ®ï¼Œä¼šå‘ç”Ÿä¸‹åˆ—æƒ…å†µï¼š

1. é™„å¸¦æ–°çš„æ–‡æœ¬æ¶ˆæ¯çš„ update ä¼šè¢«å‘é€åˆ°ä½ çš„ bot ä¸Š
2. ä»ä¼šè¯å­˜å‚¨ï¼ˆä¾‹å¦‚æ•°æ®åº“ï¼‰ä¸­åŠ è½½ä¼šè¯æ•°æ®
3. æ²¡æœ‰è°ƒç”¨å¤„ç†ç¨‹åºï¼Œæ‰€ä»¥ä¸é‡‡å–ä»»ä½•è¡ŒåŠ¨
4. ç›¸åŒçš„ä¼šè¯æ•°æ®ä¼šè¢«å†™å›åˆ°ä¼šè¯å­˜å‚¨ä¸­
5. ä¸­é—´ä»¶å®Œæˆåï¼Œå †æ•°æ®å­˜å‚¨è¿›è¡Œäº†ä¸€æ¬¡è¯»å’Œä¸€æ¬¡å†™

æ ¹æ®ä½ çš„ bot çš„æ€§è´¨ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å¤§é‡å¤šä½™çš„è¯»å’Œå†™ã€‚
å¦‚æœå‘ç°æ²¡æœ‰æ²¡æœ‰è°ƒç”¨å¤„ç†ç¨‹åºéœ€è¦ä¼šè¯æ•°æ®ï¼Œæ‡’ä¼šè¯å…è®¸ä½ è·³è¿‡æ­¥éª¤ 2 å’Œæ­¥éª¤ 4ã€‚
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ä¼šä»æ•°æ®å­˜å‚¨ä¸­è¯»å‡ºæ•°æ®ï¼Œä¹Ÿä¸ä¼šå†™å›æ•°æ®ã€‚

è¿™æ˜¯é€šè¿‡æ‹¦æˆªå¯¹ `ctx.session` çš„è®¿é—®æ¥å®ç°çš„ã€‚
å¦‚æœæ²¡æœ‰è°ƒç”¨å¤„ç†ç¨‹åºï¼Œé‚£ä¹ˆ `ctx.session` å°†æ°¸è¿œä¸ä¼šè¢«è®¿é—®ã€‚
æ‡’ä¼šè¯ä»¥è¿™ä¸ªä¸ºä¸€ä¸ªæŒ‡æ ‡æ¥é¿å…è¿›è¡Œæ•°æ®åº“é€šä¿¡ã€‚

åœ¨å®è·µä¸­ï¼Œä¸æ˜¯åœ¨ `ctx.session` ä¸‹æä¾›ä¼šè¯æ•°æ®ï¼Œè€Œæ˜¯åœ¨ `ctx.session` ä¸‹æä¾› _ä¸€ä¸ªä¼šè¯æ•°æ®çš„ promise_ã€‚

```ts
// é»˜è®¤ä¼šè¯ (ä¸¥æ ¼ä¼šè¯)
bot.command("settings", (ctx) => {
  // `session` æ˜¯ä¼šè¯æ•°æ®
  const session = ctx.session;
});

// æ‡’ä¼šè¯
bot.command("settings", async (ctx) => {
  // `promise` æ˜¯ä¼šè¯æ•°æ®çš„ä¸€ä¸ª promise
  const promise = ctx.session;
  // `session` æ˜¯ä¼šè¯æ•°æ®
  const session = await ctx.session;
});
```

å¦‚æœä½ ä¸€ç›´æ²¡æœ‰è®¿é—® `ctx.session`ï¼Œå°±ä¸ä¼šå‘ç”Ÿä»»ä½•æ“ä½œï¼Œä½†åªè¦ä½ è®¿é—®äº†ä¸Šä¸‹æ–‡å¯¹è±¡çš„ `session` å±æ€§ï¼Œå°±ä¼šè§¦å‘è¯»æ“ä½œã€‚
å¦‚æœä½ ä¸€ç›´æ²¡æœ‰è§¦å‘è¯»å–ï¼ˆæˆ–è€…ç›´æ¥ç»™ `ctx.session` èµ‹ä¸€ä¸ªæ–°å€¼ï¼‰ï¼Œå› ä¸ºå®ƒä¸å¯èƒ½è¢«æ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬ä¸éœ€è¦å†™å›ä»»ä½•æ•°æ®ã€‚
å› æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿä¼šè·³è¿‡å†™å…¥æ“ä½œã€‚
é€šè¿‡ä¸Šè¯‰æ“ä½œï¼Œæˆ‘ä»¬å®ç°äº†æœ€å°çš„è¯»å†™æ“ä½œï¼Œåªéœ€è¦åœ¨ä½ çš„ä»£ç ä¸­æ·»åŠ  `async` å’Œ `await` å…³é”®å­—ï¼Œä½ å°±å¯ä»¥åƒä¹‹å‰ä¸€æ ·ä½¿ç”¨ä¼šè¯ã€‚

æ‰€ä»¥ä½¿ç”¨æ‡’ä¼šè¯è€Œä¸æ˜¯é»˜è®¤ï¼ˆä¸¥æ ¼ï¼‰çš„ä¼šè¯éœ€è¦ä»€ä¹ˆï¼Ÿ
ä¸»è¦æ˜¯ä¸‹é¢è¿™ä¸‰ä»¶äº‹è¯·ï¼š

1. ç”¨ `LazySessionFlavor` è€Œä¸æ˜¯ `SessionFlavor` æ¥è£…é¥°ä½ çš„ä¸Šä¸‹æ–‡
   å®ƒä»¬çš„å·¥ä½œæ–¹å¼æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ `ctx.session` è¢«åŒ…è£¹åœ¨ä¸€ä¸ªæ‡’å˜é‡çš„ promise ä¸­ã€‚
2. ä½¿ç”¨ `lazySession` è€Œä¸æ˜¯ `session` æ¥æ³¨å†Œä½ çš„ä¼šè¯ä¸­é—´ä»¶ã€‚
3. åœ¨ä½ çš„ä¸­é—´ä»¶ä¸­ï¼Œä¸ç®¡æ˜¯è¯»è¿˜æ˜¯å†™ï¼Œéƒ½è¦ä½¿ç”¨å…§è”çš„ `await ctx.session` æ¥æ›¿ä»£ `ctx.session`ã€‚
   ä¸è¦æ‹…å¿ƒï¼šä½ å¯ä»¥ç”¨ä¼šè¯æ•°æ®å¤šæ¬¡ä½¿ç”¨ `await` Promiseï¼Œä½†ä½ ä¼šä¸€ç›´å¼•ç”¨ç›¸åŒçš„å€¼ï¼Œæ‰€ä»¥æ°¸è¿œä¸ä¼šæœ‰é‡å¤è¯»å–æ›´æ–°ã€‚

æ³¨æ„ï¼Œå¯¹äºæ‡’ä¼šè¯ï¼Œä½ å¯ä»¥æŠŠå¯¹è±¡å’Œ promise å¯¹è±¡éƒ½èµ‹å€¼ç»™ `ctx.session`ã€‚
å¦‚æœä½ æŠŠ `ctx.session` è®¾ç½®ä¸ºä¸€ä¸ª promiseï¼Œé‚£åœ¨æŠŠæ•°æ®å†™ä¼šæ•°æ®ä»“åº“ä¹‹å‰ï¼Œå®ƒä¼šè¢« `await`ã€‚
è¿™æ ·å¯ä»¥å®ç°ä»¥ä¸‹ä»£ç ï¼š

```ts
bot.command("reset", (ctx) => {
  // æ¯” `await ctx.session` è¦çŸ­å¾—å¤šï¼š
  ctx.session = ctx.session.then((stats) => {
    stats.counter = 0;
  });
});
```

æœ‰äººå¯èƒ½ä¼šäº‰è®ºè¯´ï¼Œæ˜ç¡®åœ°ä½¿ç”¨ `await` æ¯”èµ‹å€¼ä¸€ä¸ª promise ç»™ `ctx.session` è¦æ›´å¥½ï¼Œä½†é‡ç‚¹æ˜¯å¦‚æœä½ å‡ºäºæŸç§åŸå› æ›´å–œæ¬¢è¿™ç§é£æ ¼ï¼Œä½  _å¯ä»¥_ è¿™æ ·å†™ã€‚

::: tip éœ€è¦ä¼šè¯çš„æ’ä»¶
ä½¿ç”¨ `ctx.session` çš„æ’ä»¶å¼€å‘è€…åº”è¯¥å§‹ç»ˆå…è®¸ç”¨æˆ·ä¼ å…¥ `SessionFlavor | LazySessionFlavor`ï¼Œä»è€Œæ”¯æŒè¿™ä¸¤ç§æ¨¡å¼ã€‚
åœ¨æ’ä»¶ä»£ç ä¸­ï¼Œåªéœ€è¦ä¸€ç›´ await `ctx.session`ï¼šå¦‚æœä¸€ä¸ªé promise å¯¹è±¡è¢«ä¼ å…¥ï¼Œé‚£ä¹ˆå®ƒå°†ä¼šç®€å•åœ°è®¡ç®—ä¸ºå®ƒè‡ªå·±ï¼Œå› æ­¤ä½ å®é™…ä¸Šåªéœ€è¦æ”¯æŒæ‡’ä¼šè¯å°±èƒ½å¤Ÿè‡ªåŠ¨æ”¯æŒä¸¥æ ¼çš„ä¼šè¯ã€‚
:::

## å·²çŸ¥çš„å­˜å‚¨é€‚é…å™¨

é»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šè¯ä¼šç”±å†…ç½®çš„å­˜å‚¨é€‚é…å™¨å­˜å‚¨[åœ¨ä½ çš„å†…å­˜ä¸­](#å†…å­˜-é»˜è®¤)ã€‚
ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ grammY [å…è´¹æä¾›](#å…è´¹å­˜å‚¨) çš„å­˜å‚¨é€‚é…å™¨ï¼Œæˆ–è€…è¿æ¥åˆ° [å¤–éƒ¨å­˜å‚¨](#å¤–éƒ¨å­˜å‚¨è§£å†³æ–¹æ¡ˆ)ã€‚

ä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä¸€ä¸ªå­˜å‚¨é€‚é…å™¨æ¥å®‰è£…å®ƒã€‚

```ts
const storageAdapter = ... // å–å†³äºé…ç½®

bot.use(session({
  initial: ...
  storage: storageAdapter,
}));
```

### å†…å­˜ï¼ˆé»˜è®¤ï¼‰

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æ•°æ®éƒ½ä¼šè¢«å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚
è¿™æ„å‘³ç€ï¼Œå½“ä½ çš„æœºå™¨äººåœæ­¢æ—¶ï¼Œæ‰€æœ‰çš„ä¼šè¯éƒ½ä¼šä¸¢å¤±ã€‚

å¦‚æœä½ æƒ³é…ç½®æ›´å¤šçš„å†…å­˜å­˜å‚¨é€‰é¡¹ï¼Œä½ å¯ä»¥ä½¿ç”¨ grammY æ ¸å¿ƒåŒ…ä¸­çš„ `MemorySessionStorage` ç±»ï¼ˆ[API Reference](https://doc.deno.land/https://deno.land/x/grammy/mod.ts/~/MemorySessionStorage)ï¼‰ã€‚

```ts
bot.use(session({
  initial: ...
  storage: new MemorySessionStorage() // åŒæ ·ä½¿ç”¨é»˜è®¤é€‰é¡¹
}));
```

### å…è´¹å­˜å‚¨

> å…è´¹å­˜å‚¨æ˜¯ä¸ºäº†ç”¨äºä¸šä½™é¡¹ç›®ã€‚
> äº§å“çº§åº”ç”¨ç¨‹åºåº”è¯¥ä½¿ç”¨è‡ªå·±çš„æ•°æ®åº“ã€‚
> æ”¯æŒçš„å¤–éƒ¨å­˜å‚¨è§£å†³æ–¹æ¡ˆçš„æ”¯æŒè¯·å‚è€ƒ [è¿™é‡Œ](#å¤–éƒ¨å­˜å‚¨è§£å†³æ–¹æ¡ˆ)ã€‚

ä½¿ç”¨ grammY çš„ä¸€ä¸ªå¥½å¤„æ˜¯ä½ å¯ä»¥ä½¿ç”¨å…è´¹çš„äº‘å­˜å‚¨ã€‚
å®ƒä¸éœ€è¦ä»»ä½•é…ç½®ï¼Œæ‰€æœ‰çš„è®¤è¯éƒ½æ˜¯ç—›ä½¿ç”¨ä½ çš„ bot token å®Œæˆçš„ã€‚
æŸ¥çœ‹ [è¿™ä¸ªä»“åº“](https://github.com/grammyjs/storages/tree/main/packages/free)ï¼

å®ƒéå¸¸å®¹æ˜“ä½¿ç”¨ï¼š

<CodeGroup>
<CodeGroupItem title="TypeScript" active>

```ts
import { freeStorage } from "@grammyjs/storage-free";

bot.use(session({
  initial: ...
  storage: freeStorage<SessionData>(bot.token),
}));
```

</CodeGroupItem>
<CodeGroupItem title="JavaScript">

```ts
const { freeStorage } = require("@grammyjs/storage-free");

bot.use(session({
  initial: ...
  storage: freeStorage(bot.token),
}));
```

</CodeGroupItem>
<CodeGroupItem title="Deno">

```ts
import { freeStorage } from "https://deno.land/x/grammy_storages/free/src/mod.ts";

bot.use(session({
  initial: ...
  storage: freeStorage<SessionData>(bot.token),
}));
```

</CodeGroupItem>
</CodeGroup>

å®Œæˆï¼
ä½ çš„ bot å°†ä¼šä½¿ç”¨ä¸€ä¸ªæŒä¹…çš„æ•°æ®å­˜å‚¨ã€‚

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ bot ç¤ºä¾‹ï¼Œä½ å¯ä»¥å¤åˆ¶å®ƒæ¥è¯•è¯•ã€‚

<CodeGroup>
<CodeGroupItem title="TypeScript" active>

```ts
import { Bot, Context, session, SessionFlavor } from "grammy";
import { freeStorage } from "@grammyjs/storage-free";

// å®šä¹‰ä¼šè¯ç»“æ„ã€‚
interface SessionData {
  count: number;
}
type MyContext = Context & SessionFlavor<SessionData>;

// åˆ›å»º bot å¹¶ä¸”æ³¨å†Œä¼šè¯ä¸­é—´ä»¶ã€‚
const bot = new Bot<MyContext>(""); // <-- æŠŠä½ çš„ bot token æ”¾åœ¨ "" ä¸­é—´

bot.use(session({
  initial: () => ({ count: 0 }),
  storage: freeStorage<SessionData>(bot.token),
}));

// åœ¨ update å¤„ç†ä¸­ä½¿ç”¨æŒä¹…ä¼šè¯æ•°æ®ã€‚
bot.on("message", async (ctx) => {
  ctx.session.count++;
  await ctx.reply(`Message count: ${ctx.session.count}`);
});

bot.catch((err) => console.error(err));
bot.start();
```

</CodeGroupItem>
<CodeGroupItem title="JavaScript">

```ts
const { Bot, session } = require("grammy");
const { freeStorage } = require("@grammyjs/storage-free");

// åˆ›å»º bot å¹¶ä¸”æ³¨å†Œä¼šè¯ä¸­é—´ä»¶ã€‚
const bot = new Bot(""); // <-- æŠŠä½ çš„ bot token æ”¾åœ¨ "" ä¸­é—´

bot.use(session({
  initial: () => ({ count: 0 }),
  storage: freeStorage(bot.token),
}));

// åœ¨ update å¤„ç†ä¸­ä½¿ç”¨æŒä¹…ä¼šè¯æ•°æ®ã€‚
bot.on("message", async (ctx) => {
  ctx.session.count++;
  await ctx.reply(`Message count: ${ctx.session.count}`);
});

bot.catch((err) => console.error(err));
bot.start();
```

</CodeGroupItem>
<CodeGroupItem title="Deno">

```ts
import {
  Bot,
  Context,
  session,
  SessionFlavor,
} from "https://deno.land/x/grammy/mod.ts";
import { freeStorage } from "https://deno.land/x/grammy_storages/free/src/mod.ts";

// å®šä¹‰ä¼šè¯ç»“æ„ã€‚
interface SessionData {
  count: number;
}
type MyContext = Context & SessionFlavor<SessionData>;

// åˆ›å»º bot å¹¶ä¸”æ³¨å†Œä¼šè¯ä¸­é—´ä»¶ã€‚
const bot = new Bot<MyContext>(""); // <-- æŠŠä½ çš„ bot token æ”¾åœ¨ "" ä¸­é—´

bot.use(session({
  initial: () => ({ count: 0 }),
  storage: freeStorage<SessionData>(bot.token),
}));

// åœ¨ update å¤„ç†ä¸­ä½¿ç”¨æŒä¹…ä¼šè¯æ•°æ®ã€‚
bot.on("message", async (ctx) => {
  ctx.session.count++;
  await ctx.reply(`Message count: ${ctx.session.count}`);
});

bot.catch((err) => console.error(err));
bot.start();
```

</CodeGroupItem>
</CodeGroup>

### å¤–éƒ¨å­˜å‚¨è§£å†³æ–¹æ¡ˆ

æˆ‘ä»¬ç»´æŠ¤äº†ä¸€ä¸ªå®˜æ–¹çš„å­˜å‚¨é€‚é…å™¨åˆ—è¡¨ï¼Œå…è®¸ä½ å­˜å‚¨ä¼šè¯æ•°æ®åœ¨ä¸åŒçš„åœ°æ–¹ã€‚
å®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªéƒ½éœ€è¦ä½ åœ¨æ‰˜ç®¡æä¾›å•†å¤„æ³¨å†Œï¼Œæˆ–è€…æ‰˜ç®¡ä½ è‡ªå·±çš„å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚

- Supabase: <https://github.com/grammyjs/storages/tree/main/packages/supabase>
- Deta.sh Base: <https://github.com/grammyjs/storages/tree/main/packages/deta>
- Google Firestore (Node.js-only): <https://github.com/grammyjs/storages/tree/main/packages/firestore>
- Files: <https://github.com/grammyjs/storages/tree/main/packages/file>
- MongoDB: <https://github.com/grammyjs/storages/tree/main/packages/mongodb>
- Redis: <https://github.com/grammyjs/storages/tree/main/packages/redis>
- PostgreSQL: <https://github.com/grammyjs/storages/tree/main/packages/psql>
- TypeORM (Node.js-only): <https://github.com/grammyjs/storages/tree/main/packages/typeorm>
- DenoDB (Deno-only): <https://github.com/grammyjs/storages/tree/main/packages/denodb>

::: tip ä½ çš„å­˜å‚¨è§£å†³æ–¹æ¡ˆè¿˜æ²¡è¢«æ”¯æŒï¼Ÿæ²¡é—®é¢˜ï¼
åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰å­˜å‚¨é€‚é…å™¨éå¸¸ç®€å•ã€‚
`storage` é€‰é¡¹å¯ä»¥ä¸ä»»ä½•å®ç°äº†[è¿™ä¸ªæ¥å£](https://doc.deno.land/https://deno.land/x/grammy/mod.ts/~/StorageAdapter)çš„å¯¹è±¡è¿æ¥ï¼Œæ‰€ä»¥ä½ åªéœ€è¦åœ¨å‡ è¡Œä»£ç å°±å¯ä»¥è¿æ¥åˆ°ä½ çš„å­˜å‚¨ã€‚

> å¦‚æœä½ å‘å¸ƒäº†è‡ªå·±çš„å­˜å‚¨é€‚é…å™¨ï¼Œè¯·éšæ—¶ç¼–è¾‘è¿™ä¸ªé¡µé¢å¹¶ä¸”æ·»åŠ é“¾æ¥åˆ°è¿™é‡Œï¼Œä»¥ä¾¿å…¶ä»–äººä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒã€‚

:::

æ‰€æœ‰çš„å­˜å‚¨é€‚é…å™¨éƒ½å¯ä»¥ä»¥åŒæ ·çš„æ–¹å¼å®‰è£…ã€‚
é¦–å…ˆï¼Œä½ åº”è¯¥æ³¨æ„ä½ æ‰€é€‰æ‹©çš„å­˜å‚¨é€‚é…å™¨çš„åŒ…åã€‚
ä¾‹å¦‚ï¼ŒSupabase çš„å­˜å‚¨é€‚é…å™¨å«åš `supabase`ã€‚

**åœ¨ Node.js ä¸­**ï¼Œä½ å¯ä»¥é€šè¿‡ `npm i @grammyjs/storage-<name>` å®‰è£…é€‚é…å™¨ã€‚
ä¾‹å¦‚ï¼ŒSupabase çš„å­˜å‚¨é€‚é…å™¨å¯ä»¥é€šè¿‡ `npm i @grammyjs/storage-supabase` å®‰è£…ã€‚

**åœ¨ Deno ä¸­**ï¼Œæ‰€æœ‰çš„å­˜å‚¨é€‚é…å™¨éƒ½åœ¨åŒä¸€ä¸ª Deno æ¨¡å—ä¸­å‘å¸ƒã€‚
ä½ å¯ä»¥ä» `https://deno.land/x/grammy_storages/<adapter>/src/mod.ts` çš„å­è·¯å¾„ä¸­å¯¼å…¥ä½ éœ€è¦çš„é€‚é…å™¨ã€‚
ä¾‹å¦‚ï¼ŒSupabase çš„å­˜å‚¨é€‚é…å™¨å¯ä»¥é€šè¿‡ `https://deno.land/x/grammy_storages/supabase/src/mod.ts` å¯¼å…¥ã€‚

è¯·æŸ¥çœ‹å„è‡ªçš„ä»“åº“ï¼Œäº†è§£ä¸åŒé€‚é…å™¨çš„è®¾ç½®ã€‚
å®ƒä»¬çš„ä»“åº“ä¸­åŒ…å«äº†å¦‚ä½•è¿æ¥åˆ°ä½ çš„å­˜å‚¨è§£å†³æ–¹æ¡ˆçš„ä¿¡æ¯ã€‚

## æ’ä»¶æ¦‚è¿°

è¿™ä¸ªæ’ä»¶æ˜¯å†…ç½®åœ¨ grammY çš„æ ¸å¿ƒä¸­çš„ã€‚
ä½ ä¸éœ€è¦å®‰è£…ä»»ä½•ä¸œè¥¿æ¥ä½¿ç”¨å®ƒã€‚
åªéœ€è¦å¯¼å…¥ grammY å³å¯ã€‚

å¹¶ä¸”ï¼Œè¿™ä¸ªæ’ä»¶çš„æ–‡æ¡£å’Œ API å‚è€ƒéƒ½ä¸æ ¸å¿ƒåŒ…ä¸€è‡´ã€‚
